"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_lib_auth_ts";
exports.ids = ["_rsc_src_lib_auth_ts"];
exports.modules = {

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   verifySession: () => (/* binding */ verifySession)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/sign.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n\nconst secret = typeof process !== 'undefined' && process.env && process.env.JWT_SECRET || 'dev-secret-key-change-in-prod';\nconst JWT_SECRET = new TextEncoder().encode(secret);\nasync function hashPassword(password) {\n    const encoder = new TextEncoder();\n    const data = encoder.encode(password);\n    const hash = await crypto.subtle.digest('SHA-256', data);\n    return Array.from(new Uint8Array(hash)).map((b)=>b.toString(16).padStart(2, '0')).join('');\n}\nasync function createSession(payload) {\n    return new jose__WEBPACK_IMPORTED_MODULE_0__.SignJWT(payload).setProtectedHeader({\n        alg: 'HS256'\n    }).setIssuedAt().setExpirationTime('1d').sign(JWT_SECRET);\n}\nasync function verifySession(token) {\n    try {\n        const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_1__.jwtVerify)(token, JWT_SECRET);\n        return payload;\n    } catch (_error) {\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMEM7QUFFMUMsTUFBTUUsU0FBUyxPQUFRQyxZQUFZLGVBQWVBLFFBQVFDLEdBQUcsSUFBSUQsUUFBUUMsR0FBRyxDQUFDQyxVQUFVLElBQUs7QUFDNUYsTUFBTUEsYUFBYSxJQUFJQyxjQUFjQyxNQUFNLENBQUNMO0FBRXJDLGVBQWVNLGFBQWFDLFFBQWdCO0lBQy9DLE1BQU1DLFVBQVUsSUFBSUo7SUFDcEIsTUFBTUssT0FBT0QsUUFBUUgsTUFBTSxDQUFDRTtJQUM1QixNQUFNRyxPQUFPLE1BQU1DLE9BQU9DLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDLFdBQVdKO0lBQ25ELE9BQU9LLE1BQU1DLElBQUksQ0FBQyxJQUFJQyxXQUFXTixPQUM1Qk8sR0FBRyxDQUFDLENBQUNDLElBQU1BLEVBQUVDLFFBQVEsQ0FBQyxJQUFJQyxRQUFRLENBQUMsR0FBRyxNQUN0Q0MsSUFBSSxDQUFDO0FBQ2Q7QUFFTyxlQUFlQyxjQUFjQyxPQUEyRDtJQUMzRixPQUFPLElBQUl6Qix5Q0FBT0EsQ0FBQ3lCLFNBQ2RDLGtCQUFrQixDQUFDO1FBQUVDLEtBQUs7SUFBUSxHQUNsQ0MsV0FBVyxHQUNYQyxpQkFBaUIsQ0FBQyxNQUNsQkMsSUFBSSxDQUFDekI7QUFDZDtBQUVPLGVBQWUwQixjQUFjQyxLQUFhO0lBQzdDLElBQUk7UUFDQSxNQUFNLEVBQUVQLE9BQU8sRUFBRSxHQUFHLE1BQU14QiwrQ0FBU0EsQ0FBQytCLE9BQU8zQjtRQUMzQyxPQUFPb0I7SUFDWCxFQUFFLE9BQU9RLFFBQVE7UUFDYixPQUFPO0lBQ1g7QUFDSiIsInNvdXJjZXMiOlsiRDpcXEdhcmF5aS1jbG91ZFxcc3JjXFxsaWJcXGF1dGgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2lnbkpXVCwgand0VmVyaWZ5IH0gZnJvbSAnam9zZSc7XHJcblxyXG5jb25zdCBzZWNyZXQgPSAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpIHx8ICdkZXYtc2VjcmV0LWtleS1jaGFuZ2UtaW4tcHJvZCc7XHJcbmNvbnN0IEpXVF9TRUNSRVQgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VjcmV0KTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XHJcbiAgICBjb25zdCBkYXRhID0gZW5jb2Rlci5lbmNvZGUocGFzc3dvcmQpO1xyXG4gICAgY29uc3QgaGFzaCA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgZGF0YSk7XHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShoYXNoKSlcclxuICAgICAgICAubWFwKChiKSA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxyXG4gICAgICAgIC5qb2luKCcnKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNlc3Npb24ocGF5bG9hZDogeyB1c2VySWQ6IG51bWJlcjsgdXNlcm5hbWU6IHN0cmluZzsgcm9sZTogc3RyaW5nIH0pIHtcclxuICAgIHJldHVybiBuZXcgU2lnbkpXVChwYXlsb2FkKVxyXG4gICAgICAgIC5zZXRQcm90ZWN0ZWRIZWFkZXIoeyBhbGc6ICdIUzI1NicgfSlcclxuICAgICAgICAuc2V0SXNzdWVkQXQoKVxyXG4gICAgICAgIC5zZXRFeHBpcmF0aW9uVGltZSgnMWQnKVxyXG4gICAgICAgIC5zaWduKEpXVF9TRUNSRVQpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5U2Vzc2lvbih0b2tlbjogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgcGF5bG9hZCB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKTtcclxuICAgICAgICByZXR1cm4gcGF5bG9hZDtcclxuICAgIH0gY2F0Y2ggKF9lcnJvcikge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJTaWduSldUIiwiand0VmVyaWZ5Iiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsImhhc2hQYXNzd29yZCIsInBhc3N3b3JkIiwiZW5jb2RlciIsImRhdGEiLCJoYXNoIiwiY3J5cHRvIiwic3VidGxlIiwiZGlnZXN0IiwiQXJyYXkiLCJmcm9tIiwiVWludDhBcnJheSIsIm1hcCIsImIiLCJ0b1N0cmluZyIsInBhZFN0YXJ0Iiwiam9pbiIsImNyZWF0ZVNlc3Npb24iLCJwYXlsb2FkIiwic2V0UHJvdGVjdGVkSGVhZGVyIiwiYWxnIiwic2V0SXNzdWVkQXQiLCJzZXRFeHBpcmF0aW9uVGltZSIsInNpZ24iLCJ2ZXJpZnlTZXNzaW9uIiwidG9rZW4iLCJfZXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ })

};
;