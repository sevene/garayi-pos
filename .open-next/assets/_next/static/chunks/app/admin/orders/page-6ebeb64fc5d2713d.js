(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4798],{367:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(5155),a=r(2115),n=r(7650),l=r(5748),i=r(6059);function c(e){let{options:t,value:r,onChange:c,placeholder:o="Select an option",label:d,className:x="",disabled:m=!1,required:u=!1,error:h=!1,name:p,id:g}=e,[y,f]=(0,a.useState)(!1),b=(0,a.useRef)(null),j=(0,a.useRef)(null),[w,v]=(0,a.useState)({top:0,left:0,width:0}),N=g||p,k=()=>{if(b.current){let e=b.current.getBoundingClientRect();v({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width})}};(0,a.useEffect)(()=>{let e=e=>{let t=e.target,r=b.current&&b.current.contains(t),s=j.current&&j.current.contains(t);r||s||f(!1)},t=e=>{let t=e.target;y&&j.current&&!j.current.contains(t)&&f(!1)},r=()=>{y&&k()};return document.addEventListener("mousedown",e),window.addEventListener("scroll",t,!0),window.addEventListener("resize",r),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",t,!0),window.removeEventListener("resize",r)}},[y]),(0,a.useEffect)(()=>{y&&k()},[y]);let E=t.find(e=>e.value===r),L=(0,s.jsx)("div",{ref:j,className:"fixed z-9999 bg-white shadow-xl rounded-lg text-base ring-1 ring-gray-200 ring-opacity-5 overflow-hidden focus:outline-none sm:text-sm mt-1",style:{top:w.top,left:w.left,width:w.width},children:(0,s.jsx)("div",{className:"max-h-60 overflow-auto py-1",children:0===t.length?(0,s.jsx)("div",{className:"cursor-default select-none relative py-2 px-3 text-gray-500 text-center",children:"No options available."}):t.map(e=>(0,s.jsxs)("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 text-left hover:bg-lime-50 transition-colors ".concat(r===e.value?"bg-lime-50 text-lime-900 font-medium":"text-neutral-500"),onClick:t=>{t.stopPropagation(),c(e.value),f(!1)},children:[(0,s.jsx)("span",{className:"block truncate",children:e.label}),r===e.value&&(0,s.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-4 text-lime-600",children:(0,s.jsx)(l.A,{className:"h-5 w-5","aria-hidden":"true"})})]},e.value))})});return(0,s.jsxs)("div",{className:"relative w-full ".concat(x),ref:b,children:[d&&(0,s.jsxs)("label",{htmlFor:N,className:"block text-sm font-medium text-gray-700 mb-1",children:[d,u&&(0,s.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,s.jsxs)("button",{id:N,type:"button",onClick:()=>!m&&f(!y),disabled:m,className:"w-full flex items-center justify-between px-3 py-2 border rounded-lg bg-white text-left text-sm transition-all\n                    ".concat(m?"bg-gray-50 text-gray-400 cursor-not-allowed":"cursor-pointer","\n                    ").concat(h?" ring-2 ring-red-500/20 border-red-300 bg-red-50 hover:border-red-400":"border-gray-200 hover:border-gray-300","\n                    ").concat(y?"ring-2 ring-lime-500/20 border-lime-500 outline-none":"","\n                "),children:[(0,s.jsx)("span",{className:"block truncate ".concat(E?"text-gray-900":"text-gray-400"),children:E?E.label:o}),(0,s.jsx)(i.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(y?"rotate-180":"")})]}),y&&!m&&"undefined"!=typeof document&&(0,n.createPortal)(L,document.body)]})}},874:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(2115);let a=s.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?s.createElement("title",{id:a},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))})},2507:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);function a(e){let{title:t,description:r,className:a=""}=e;return(0,s.jsxs)("div",{className:"relative ".concat(a),children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:t}),r&&(0,s.jsx)("p",{className:"text-base font-normal text-gray-700 mt-2 tracking-wide",children:r})]})}r(2115)},5748:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(2115);let a=s.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?s.createElement("title",{id:a},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))})},6059:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(2115);let a=s.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?s.createElement("title",{id:a},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))})},7065:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(2115),n=r(874);let l=a.forwardRef(function(e,t){let{title:r,titleId:s,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}),i=a.forwardRef(function(e,t){let{title:r,titleId:s,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),r?a.createElement("title",{id:s},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))});var c=r(6059),o=r(9554),d=r(367),x=r(9749),m=r(8720),u=r(2507);function h(){let[e,t]=(0,a.useState)([]),[r,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null),[y,f]=(0,a.useState)("ALL"),[b,j]=(0,a.useState)(""),[w,v]=(0,a.useState)(new Set),{settings:N,formatCurrency:k}=(0,x.t)(),E=(null==N?void 0:N.taxRate)||0,L="/api",C=async()=>{if(L){h(!0),g(null);try{let e=await fetch("".concat(L,"/tickets?all=true"));if(!e.ok)throw Error("Failed to fetch orders");let r=await e.json();t(r)}catch(e){console.error(e),g("Failed to load orders")}finally{h(!1)}}};(0,a.useEffect)(()=>{C()},[]);let S=async(e,r)=>{if(r.stopPropagation(),confirm("Are you sure you want to delete this order? This action cannot be undone."))try{if(!(await fetch("".concat(L,"/tickets/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete order");t(t=>t.filter(t=>t._id!==e)),m.oR.success("Order deleted successfully")}catch(e){console.error(e),m.oR.error("Failed to delete order")}},A=(0,a.useMemo)(()=>e.filter(e=>("ALL"===y||(e.status||"PENDING")===y)&&(!b||new Date(e.createdAt).toISOString().split("T")[0]===b)&&!0),[e,y,b]);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-1000 lg:px-6 lg:pb-6 flex flex-row justify-between items-center",children:[(0,s.jsx)(u.A,{title:"Orders Management",description:"View and manage all customer orders"}),(0,s.jsxs)("button",{onClick:C,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors shadow-sm",children:[(0,s.jsx)(n.A,{className:"w-5 h-5 ".concat(r?"animate-spin":"")}),"Refresh"]})]}),p&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg",children:p}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-md mb-6 flex flex-wrap gap-4 items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 mr-2",children:[(0,s.jsx)(l,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:"Filters:"})]}),(0,s.jsx)("div",{className:"w-48",children:(0,s.jsx)(d.A,{options:[{label:"All Statuses",value:"ALL"},{label:"Pending",value:"PENDING"},{label:"Completed",value:"COMPLETED"},{label:"Cancelled",value:"CANCELLED"}],value:y,onChange:e=>f(e),placeholder:"Filter by Status"})}),(0,s.jsx)("input",{type:"date",value:b,onChange:e=>j(e.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-lime-500/20 focus:border-lime-500 outline-none"}),("ALL"!==y||b)&&(0,s.jsx)("button",{onClick:()=>{f("ALL"),j("")},className:"text-sm text-red-500 hover:text-red-700 font-medium",children:"Clear Filters"})]}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-left text-sm text-gray-600",children:[(0,s.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200 font-medium text-gray-900 uppercase tracking-wider",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4",children:"Name / Order ID"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center",children:"Date"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center",children:"Payment"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center",children:"Items"}),(0,s.jsx)("th",{className:"px-6 py-4 text-right",children:"Total"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:r&&0===e.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"Loading orders..."})}):0===A.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No orders found matching your filters."})}):A.map(e=>{let t=w.has(e._id);return(0,s.jsxs)(a.Fragment,{children:[(0,s.jsxs)("tr",{onClick:()=>{var t;return t=e._id,void v(e=>{let r=new Set(e);return r.has(t)?r.delete(t):r.add(t),r})},className:"hover:bg-gray-50 transition-colors cursor-pointer ".concat(t?"bg-gray-50":""),children:[(0,s.jsxs)("td",{className:"px-6 py-4 flex flex-row gap-6 items-center",children:[t?(0,s.jsx)(i,{className:"w-4 h-4 text-gray-500"}):(0,s.jsx)(c.A,{className:"w-4 h-4 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-bold text-gray-900",children:e.name||"Unnamed Order"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 font-medium",children:e.customer?"object"==typeof e.customer?e.customer.name:"Unknown Customer":"No Customer"}),(0,s.jsx)("div",{className:"text-xs text-gray-400 mt-0.5",children:e._id})]})]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:new Date(e.createdAt).toLocaleString()}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-bold ".concat((e=>{switch(e){case"COMPLETED":return"bg-green-100 text-green-800";case"CANCELLED":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}})(e.status||"PENDING")),children:e.status||"PENDING"})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-700",children:e.paymentMethod||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:(0,s.jsxs)("div",{className:"max-w-xs truncate",children:[e.items.length," items"]})}),(0,s.jsx)("td",{className:"px-6 py-4 text-right font-bold text-gray-900",children:k((e=>{if(e.total)return e.total;let t=e.items.reduce((e,t)=>e+t.unitPrice*t.quantity,0);return t+t*E})(e))}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:(0,s.jsx)("button",{onClick:t=>S(e._id,t),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Order",children:(0,s.jsx)(o.A,{className:"w-5 h-5"})})})]}),t&&(0,s.jsx)("tr",{className:"bg-gray-50",children:(0,s.jsx)("td",{colSpan:7,className:"px-6 py-4 border-t border-gray-100",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(e.customer||e.crew&&e.crew.length>0)&&(0,s.jsxs)("div",{className:"mb-6 grid grid-cols-2 gap-6 pb-6 border-b border-gray-100",children:[e.customer&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:"Customer"}),(0,s.jsx)("div",{className:"text-sm font-semibold text-gray-800",children:"object"==typeof e.customer?e.customer.name:"Unknown"}),"object"==typeof e.customer&&e.customer.contactInfo&&(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:e.customer.contactInfo}),(()=>{var t;let r=(null==(t=e.customerSnapshot)?void 0:t.carDetails)||("object"==typeof e.customer&&e.customer.cars&&e.customer.cars.length>0?e.customer.cars[0]:null);return r?(0,s.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 rounded-lg border border-gray-100 inline-block",children:[(0,s.jsxs)("div",{className:"text-xs font-bold text-gray-700",children:[r.makeModel||"Unknown Model"," ",(0,s.jsxs)("span",{className:"font-normal text-gray-500",children:["• ",r.color||"No Color"]})]}),(0,s.jsx)("div",{className:"text-xs font-mono font-bold text-lime-700 bg-lime-50 border border-lime-200 rounded px-1.5 py-0.5 mt-1 inline-block",children:r.plateNumber||"NO PLATE"})]}):null})()]}),e.crew&&e.crew.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:["Assigned Crew (",e.crew.length,")"]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.crew.map((e,t)=>(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-lime-100 text-lime-800",children:"object"==typeof e?e.name:"ID: "+e},t))})]})]}),(0,s.jsx)("h4",{className:"font-bold text-gray-700 mb-3 text-sm uppercase tracking-wide",children:"Order Details"}),(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"text-xs text-gray-500 bg-gray-50 border-b border-gray-100",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"py-2 px-3 text-left",children:"Product"}),(0,s.jsx)("th",{className:"py-2 px-3 text-center",children:"Qty"}),(0,s.jsx)("th",{className:"py-2 px-3 text-right",children:"Unit Price"}),(0,s.jsx)("th",{className:"py-2 px-3 text-right",children:"Total"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-100",children:e.items.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"py-2 px-3 text-gray-800",children:e.productName}),(0,s.jsx)("td",{className:"py-2 px-3 text-center text-gray-600",children:e.quantity}),(0,s.jsx)("td",{className:"py-2 px-3 text-right text-gray-600",children:k(e.unitPrice)}),(0,s.jsx)("td",{className:"py-2 px-3 text-right font-medium text-gray-800",children:k(e.unitPrice*e.quantity)})]},t))}),(0,s.jsxs)("tfoot",{className:"border-t border-gray-200",children:[e.paymentMethod&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{colSpan:3,className:"py-2 px-3 text-right font-bold text-gray-600",children:"Payment Method"}),(0,s.jsx)("td",{className:"py-2 px-3 text-right font-bold text-lime-600",children:e.paymentMethod})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{colSpan:3,className:"py-2 px-3 text-right font-bold text-gray-600",children:"Subtotal"}),(0,s.jsx)("td",{className:"py-2 px-3 text-right font-bold text-gray-800",children:k(e.items.reduce((e,t)=>e+t.unitPrice*t.quantity,0))})]}),(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{colSpan:3,className:"py-1 px-3 text-right text-gray-500 text-xs",children:["Tax (",Number((100*E).toFixed(2)),"%)"]}),(0,s.jsx)("td",{className:"py-1 px-3 text-right text-gray-500 text-xs",children:k(e.items.reduce((e,t)=>e+t.unitPrice*t.quantity,0)*E)})]})]})]})]})})})]},e._id)})})]})})})]})}},9003:(e,t,r)=>{Promise.resolve().then(r.bind(r,7065))},9554:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(2115);let a=s.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?s.createElement("title",{id:a},r):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))})},9749:(e,t,r)=>{"use strict";r.d(t,{t:()=>a});var s=r(2115);let a=()=>{let[e,t]=(0,s.useState)(null),[r,a]=(0,s.useState)(!0),[n,l]=(0,s.useState)(null),i="/api";return(0,s.useEffect)(()=>{(async()=>{if(!i)return a(!1);try{let a=await fetch("".concat(i,"/settings"));if(a.ok){var e,r,s,n,c,o,d;let l=await a.json();t({storeName:l.name||"",storeAddress:(null==(e=l.address)?void 0:e.street)||"",currency:l.currency||"PHP",taxRate:void 0!==l.tax_rate?Number(l.tax_rate):.08,enableNotifications:null==(d=null==(r=l.settings)?void 0:r.enableNotifications)||d,receiptHeader:(null==(s=l.receipt)?void 0:s.header)||"",receiptFooter:(null==(n=l.receipt)?void 0:n.footer)||"",printerName:(null==(c=l.receipt)?void 0:c.printerName)||"",theme:(null==(o=l.settings)?void 0:o.theme)||"light"})}else l("Failed to fetch settings")}catch(e){console.error(e),l("Error fetching settings")}finally{a(!1)}})()},[i]),{settings:e,loading:r,error:n,formatCurrency:t=>{let r=(null==e?void 0:e.currency)==="USD"?"$":(null==e?void 0:e.currency)==="EUR"?"€":"₱";return"".concat(r).concat(t.toFixed(2))},getCurrencySymbol:()=>e?"USD"===e.currency?"$":"EUR"===e.currency?"€":"₱":"₱"}}}},e=>{e.O(0,[8720,8441,1255,7358],()=>e(e.s=9003)),_N_E=e.O()}]);