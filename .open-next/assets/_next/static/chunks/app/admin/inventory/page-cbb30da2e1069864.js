(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17],{367:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(5155),a=r(2115),l=r(7650),s=r(5748),o=r(6059);function i(e){let{options:t,value:r,onChange:i,placeholder:c="Select an option",label:d,className:u="",disabled:m=!1,required:x=!1,error:h=!1,name:f,id:p}=e,[g,y]=(0,a.useState)(!1),v=(0,a.useRef)(null),w=(0,a.useRef)(null),[b,j]=(0,a.useState)({top:0,left:0,width:0}),N=p||f,k=()=>{if(v.current){let e=v.current.getBoundingClientRect();j({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width})}};(0,a.useEffect)(()=>{let e=e=>{let t=e.target,r=v.current&&v.current.contains(t),n=w.current&&w.current.contains(t);r||n||y(!1)},t=e=>{let t=e.target;g&&w.current&&!w.current.contains(t)&&y(!1)},r=()=>{g&&k()};return document.addEventListener("mousedown",e),window.addEventListener("scroll",t,!0),window.addEventListener("resize",r),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",t,!0),window.removeEventListener("resize",r)}},[g]),(0,a.useEffect)(()=>{g&&k()},[g]);let E=t.find(e=>e.value===r),S=(0,n.jsx)("div",{ref:w,className:"fixed z-9999 bg-white shadow-xl rounded-lg text-base ring-1 ring-gray-200 ring-opacity-5 overflow-hidden focus:outline-none sm:text-sm mt-1",style:{top:b.top,left:b.left,width:b.width},children:(0,n.jsx)("div",{className:"max-h-60 overflow-auto py-1",children:0===t.length?(0,n.jsx)("div",{className:"cursor-default select-none relative py-2 px-3 text-gray-500 text-center",children:"No options available."}):t.map(e=>(0,n.jsxs)("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 text-left hover:bg-lime-50 transition-colors ".concat(r===e.value?"bg-lime-50 text-lime-900 font-medium":"text-neutral-500"),onClick:t=>{t.stopPropagation(),i(e.value),y(!1)},children:[(0,n.jsx)("span",{className:"block truncate",children:e.label}),r===e.value&&(0,n.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-4 text-lime-600",children:(0,n.jsx)(s.A,{className:"h-5 w-5","aria-hidden":"true"})})]},e.value))})});return(0,n.jsxs)("div",{className:"relative w-full ".concat(u),ref:v,children:[d&&(0,n.jsxs)("label",{htmlFor:N,className:"block text-sm font-medium text-gray-700 mb-1",children:[d,x&&(0,n.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,n.jsxs)("button",{id:N,type:"button",onClick:()=>!m&&y(!g),disabled:m,className:"w-full flex items-center justify-between px-3 py-2 border rounded-lg bg-white text-left text-sm transition-all\n                    ".concat(m?"bg-gray-50 text-gray-400 cursor-not-allowed":"cursor-pointer","\n                    ").concat(h?" ring-2 ring-red-500/20 border-red-300 bg-red-50 hover:border-red-400":"border-gray-200 hover:border-gray-300","\n                    ").concat(g?"ring-2 ring-lime-500/20 border-lime-500 outline-none":"","\n                "),children:[(0,n.jsx)("span",{className:"block truncate ".concat(E?"text-gray-900":"text-gray-400"),children:E?E.label:c}),(0,n.jsx)(o.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(g?"rotate-180":"")})]}),g&&!m&&"undefined"!=typeof document&&(0,l.createPortal)(S,document.body)]})}},652:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var n=r(5155),a=r(2115),l=r(5239),s=r(1715),o=r(6696),i=r(3569),c=r(874),d=r(5748),u=r(367),m=r(8720),x=r(2507);let h=["Manual Adjustment","Restock / Purchase","Damage / Spoilage","Theft / Loss","Inventory Correction","Return from Customer","Internal Use / Promo"];function f(){let[e,t]=(0,a.useState)([]),[r,f]=(0,a.useState)(!0),[p,g]=(0,a.useState)(""),[y,v]=(0,a.useState)({}),[w,b]=(0,a.useState)({}),[j,N]=(0,a.useState)(new Set),[k,E]=(0,a.useState)(new Set),S=(0,a.useCallback)(async()=>{try{f(!0);let e="/api";if(!e)throw Error("API URL is not configured.");let r=await fetch("".concat(e,"/products"));if(r.ok){let e=await r.json();t(e)}}catch(e){console.error("Failed to load inventory.",e)}finally{f(!1)}},[]);(0,a.useEffect)(()=>{S()},[S]);let _=async e=>{let r=y[e._id];""===r&&(r=0);let n=r,a=w[e._id];if(!a){E(t=>new Set(t).add(e._id)),m.oR.error("Please select an adjustment reason.");return}if(void 0!==n&&n!==e.stock){N(t=>new Set(t).add(e._id));try{let r="/api";if(!r)throw Error("API URL is not configured.");if(!(await fetch("".concat(r,"/inventories/product/").concat(e._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({stock:n,reason:a})})).ok)throw Error("Failed to update stock");t(t=>t.map(t=>t._id===e._id?{...t,stock:n}:t)),v(t=>{let r={...t};return delete r[e._id],r}),b(t=>{let r={...t};return delete r[e._id],r}),m.oR.success("Stock updated successfully")}catch(e){console.error("Error updating stock:",e),m.oR.error("Failed to update stock. Please try again.")}finally{N(t=>{let r=new Set(t);return r.delete(e._id),r})}}},C=e.filter(e=>{var t;return e.name.toLowerCase().includes(p.toLowerCase())||(null==(t=e.sku)?void 0:t.toLowerCase().includes(p.toLowerCase()))});return(0,n.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-1000 lg:px-6 lg:pb-6",children:[(0,n.jsx)(x.A,{title:"Inventory Management",description:"Manage your inventory and pricing"}),(0,n.jsx)("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(s.A,{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,n.jsx)("input",{type:"text",name:"inventorySearch",placeholder:"Search products...",value:p,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lime-500 outline-none"})]})}),(0,n.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:(0,n.jsx)("div",{children:(0,n.jsxs)("table",{className:"min-w-full text-left border-collapse",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200 text-xs uppercase text-gray-500 font-semibold",children:[(0,n.jsx)("th",{className:"px-6 py-4 rounded-tl-xl",children:"Product"}),(0,n.jsx)("th",{className:"px-6 py-4 text-center",children:"SKU"}),(0,n.jsx)("th",{className:"px-6 py-4 text-center",children:"Current Stock"}),(0,n.jsx)("th",{className:"px-6 py-4 text-center",children:"Status"}),(0,n.jsx)("th",{className:"px-6 py-4 text-center",children:"Reason"}),(0,n.jsx)("th",{className:"px-6 py-4 text-center rounded-tr-xl",children:"Actions"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-gray-100",children:r?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"Loading..."})}):0===C.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No products found."})}):C.map(e=>{var t,r;let a=null!=(r=null!=(t=y[e._id])?t:e.stock)?r:0,s=void 0!==y[e._id]&&y[e._id]!==e.stock,m=j.has(e._id);return(0,n.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center overflow-hidden shrink-0 text-gray-400",children:e.image?(0,n.jsx)(l.default,{src:e.image,alt:e.name,width:40,height:40,className:"object-cover w-full h-full"}):(0,n.jsx)(o.A,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,n.jsx)("div",{className:"text-xs text-gray-500",children:"object"==typeof e.category&&null!==e.category?e.category.name:e.category||"Uncategorized"})]})]})}),(0,n.jsx)("td",{className:"px-6 py-4 text-center text-sm font-mono text-gray-500",children:e.sku||"—"}),(0,n.jsx)("td",{className:"px-6 py-4 text-center",children:(0,n.jsx)("input",{type:"number",name:"currentStock",min:"0",value:""===a?"":Number(a).toString(),onChange:t=>((e,t)=>{if(t.length>1&&t.startsWith("0")&&(t=t.replace(/^0+/,"")),""===t)v(t=>({...t,[e]:""}));else{let r=parseInt(t);!isNaN(r)&&r>=0&&v(t=>({...t,[e]:r}))}})(e._id,t.target.value),onFocus:e=>e.target.select(),className:"w-24 text-center border rounded-lg py-1.5 text-sm outline-none transition\n                                                        ".concat(s?"border-lime-500 ring-2 ring-lime-500/20 bg-lime-50":"border-gray-200 focus:border-lime-500")})}),(0,n.jsx)("td",{className:"px-6 py-4 text-center",children:(0,n.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\n                                                    ".concat(Number(a)>10?"bg-green-100 text-green-800":Number(a)>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:Number(a)>10?"In Stock":Number(a)>0?"Low Stock":"Out of Stock"})}),(0,n.jsx)("td",{className:"px-6 py-4 text-center",children:s?(0,n.jsx)("div",{className:"w-full mx-auto",children:(0,n.jsx)(u.A,{options:h.map(e=>({label:e,value:e})),value:w[e._id]||"",onChange:t=>{var r;return r=e._id,void(b(e=>({...e,[r]:t})),E(e=>{let t=new Set(e);return t.delete(r),t}))},placeholder:"Select Reason",error:k.has(e._id)})}):(0,n.jsx)("span",{className:"text-gray-400 text-sm",children:"—"})}),(0,n.jsx)("td",{className:"px-6 py-4 text-center h-16",children:s&&(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,n.jsxs)("button",{onClick:()=>{var t;return t=e._id,void(v(e=>{let r={...e};return delete r[t],r}),b(e=>{let r={...e};return delete r[t],r}),E(e=>{let r=new Set(e);return r.delete(t),r}))},disabled:m,className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-gray-100 text-gray-400 text-sm font-medium rounded-md hover:bg-gray-200 hover:text-gray-600 transition",title:"Cancel",children:[(0,n.jsx)(i.A,{className:"w-4 h-4"}),"Cancel"]}),(0,n.jsxs)("button",{onClick:()=>_(e),disabled:m,className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-lime-500 text-white text-sm font-medium rounded-md hover:bg-lime-600 transition shadow-sm disabled:opacity-50",children:[m?(0,n.jsx)(c.A,{className:"w-3.5 h-3.5 animate-spin"}):(0,n.jsx)(d.A,{className:"w-3.5 h-3.5"}),"Save"]})]})})]},e._id)})})]})})})]})}},874:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(2115);let a=n.forwardRef(function(e,t){let{title:r,titleId:a,...l}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))})},1715:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(2115);let a=n.forwardRef(function(e,t){let{title:r,titleId:a,...l}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))})},2507:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(5155);function a(e){let{title:t,description:r,className:a=""}=e;return(0,n.jsxs)("div",{className:"relative ".concat(a),children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:t}),r&&(0,n.jsx)("p",{className:"text-base font-normal text-gray-700 mt-2 tracking-wide",children:r})]})}r(2115)},3011:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let n=r(2115);function a(e,t){let r=(0,n.useRef)(null),a=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=l(e,n)),t&&(a.current=l(t,n))},[e,t])}function l(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3569:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(2115);let a=n.forwardRef(function(e,t){let{title:r,titleId:a,...l}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))})},5296:(e,t,r)=>{Promise.resolve().then(r.bind(r,652))},5748:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(2115);let a=n.forwardRef(function(e,t){let{title:r,titleId:a,...l}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))})},6059:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(2115);let a=n.forwardRef(function(e,t){let{title:r,titleId:a,...l}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))})},6696:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(2115);let a=n.forwardRef(function(e,t){let{title:r,titleId:a,...l}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))})}},e=>{e.O(0,[8720,5239,8441,1255,7358],()=>e(e.s=5296)),_N_E=e.O()}]);