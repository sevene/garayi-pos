"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4068],{194:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))})},367:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(5155),l=r(2115),n=r(7650),s=r(5748),i=r(6059);function o(e){let{options:t,value:r,onChange:o,placeholder:c="Select an option",label:d,className:u="",disabled:m=!1,required:x=!1,error:h=!1,name:g,id:f}=e,[p,b]=(0,l.useState)(!1),v=(0,l.useRef)(null),y=(0,l.useRef)(null),[w,j]=(0,l.useState)({top:0,left:0,width:0}),N=f||g,k=()=>{if(v.current){let e=v.current.getBoundingClientRect();j({top:e.bottom+window.scrollY,left:e.left+window.scrollX,width:e.width})}};(0,l.useEffect)(()=>{let e=e=>{let t=e.target,r=v.current&&v.current.contains(t),a=y.current&&y.current.contains(t);r||a||b(!1)},t=e=>{let t=e.target;p&&y.current&&!y.current.contains(t)&&b(!1)},r=()=>{p&&k()};return document.addEventListener("mousedown",e),window.addEventListener("scroll",t,!0),window.addEventListener("resize",r),()=>{document.removeEventListener("mousedown",e),window.removeEventListener("scroll",t,!0),window.removeEventListener("resize",r)}},[p]),(0,l.useEffect)(()=>{p&&k()},[p]);let C=t.find(e=>e.value===r),E=(0,a.jsx)("div",{ref:y,className:"fixed z-9999 bg-white shadow-xl rounded-lg text-base ring-1 ring-gray-200 ring-opacity-5 overflow-hidden focus:outline-none sm:text-sm mt-1",style:{top:w.top,left:w.left,width:w.width},children:(0,a.jsx)("div",{className:"max-h-60 overflow-auto py-1",children:0===t.length?(0,a.jsx)("div",{className:"cursor-default select-none relative py-2 px-3 text-gray-500 text-center",children:"No options available."}):t.map(e=>(0,a.jsxs)("div",{className:"cursor-pointer select-none relative py-2 pl-3 pr-9 text-left hover:bg-lime-50 transition-colors ".concat(r===e.value?"bg-lime-50 text-lime-900 font-medium":"text-neutral-500"),onClick:t=>{t.stopPropagation(),o(e.value),b(!1)},children:[(0,a.jsx)("span",{className:"block truncate",children:e.label}),r===e.value&&(0,a.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-4 text-lime-600",children:(0,a.jsx)(s.A,{className:"h-5 w-5","aria-hidden":"true"})})]},e.value))})});return(0,a.jsxs)("div",{className:"relative w-full ".concat(u),ref:v,children:[d&&(0,a.jsxs)("label",{htmlFor:N,className:"block text-sm font-medium text-gray-700 mb-1",children:[d,x&&(0,a.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,a.jsxs)("button",{id:N,type:"button",onClick:()=>!m&&b(!p),disabled:m,className:"w-full flex items-center justify-between px-3 py-2 border rounded-lg bg-white text-left text-sm transition-all\n                    ".concat(m?"bg-gray-50 text-gray-400 cursor-not-allowed":"cursor-pointer","\n                    ").concat(h?" ring-2 ring-red-500/20 border-red-300 bg-red-50 hover:border-red-400":"border-gray-200 hover:border-gray-300","\n                    ").concat(p?"ring-2 ring-lime-500/20 border-lime-500 outline-none":"","\n                "),children:[(0,a.jsx)("span",{className:"block truncate ".concat(C?"text-gray-900":"text-gray-400"),children:C?C.label:c}),(0,a.jsx)(i.A,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(p?"rotate-180":"")})]}),p&&!m&&"undefined"!=typeof document&&(0,n.createPortal)(E,document.body)]})}},874:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))})},1715:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))})},2019:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 0 0-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 0 1-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 0 0 3 15h-.75M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm3 0h.008v.008H18V10.5Zm-12 0h.008v.008H6V10.5Z"}))})},3569:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))})},3641:(e,t,r)=>{r.d(t,{POSGrid:()=>c});var a=r(5155),l=r(2115),n=r(8892),s=r(9749);function i(e){let{service:t,onSelect:r,onClose:l}=e,{formatCurrency:n}=(0,s.t)();return t.variants&&0!==t.variants.length?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:t.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Select a variation"})]}),(0,a.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-200 rounded-full text-gray-500 transition-colors",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"p-6 grid gap-3 max-h-[60vh] overflow-y-auto",children:t.variants.map((e,t)=>(0,a.jsxs)("button",{onClick:()=>r(e),className:"flex items-center justify-between p-4 rounded-xl border border-gray-200 hover:border-gray-500 transition-all group text-left",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700 group-hover:text-lime-700",children:e.name}),(0,a.jsx)("span",{className:"font-bold text-lime-600 bg-lime-50 px-2.5 py-1 rounded-lg text-sm",children:n(e.price)})]},t))})]})}):null}var o=r(1715);function c(e){let{initialServices:t,initialProducts:r,initialCategories:s}=e,{addItemToCart:c,formatCurrency:d}=(0,n._)(),[u,m]=(0,l.useState)(""),[x,h]=(0,l.useState)("all"),[g,f]=(0,l.useState)(null),[p,b]=(0,l.useState)(!1),v=(0,l.useMemo)(()=>[...t.filter(e=>!1!==e.showInPos),...r.filter(e=>!1!==e.showInPos)],[t,r]),y=(0,l.useMemo)(()=>{let e=new Set;return v.forEach(t=>{let r=t.category;if(!r)return;let a="object"==typeof r?r._id:r;a&&e.add(a)}),s.filter(t=>e.has(t._id))},[v,s]),w=(0,l.useMemo)(()=>{let e=v;if(u){let t=u.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||"sku"in e&&e.sku.toLowerCase().includes(t))}return e},[v,u]),j=(0,l.useMemo)(()=>{let e={};return w.forEach(t=>{let r=(e=>{let t=e.category;return t?"object"==typeof t?t._id:t:"uncategorized"})(t);e[r]||(e[r]=[]),e[r].push(t)}),e},[w]),N=(0,l.useMemo)(()=>{let e=[];if("all"!==x){let r=j[x]||[];if(r.length>0){var t;let a=(null==(t=s.find(e=>e._id===x))?void 0:t.name)||"Unknown Category";e.push({id:x,name:a,items:r})}}else{let t=[];y.forEach(e=>{let r=j[e._id];r&&r.length>0&&t.push(...r)}),j.uncategorized&&j.uncategorized.length>0&&t.push(...j.uncategorized),t.length>0&&e.push({id:"all",name:"All Items",items:t})}return e},[j,x,y,s]);return(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden bg-white",children:[(0,a.jsx)("div",{className:"px-6 py-[17.5px] shrink-0 flex flex-col z-10 transition-all duration-300 ease-in-out overflow-hidden",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex gap-1 overflow-x-auto scrollbar-hide py-1 px-1 bg-gray-50 font-base min-w-0 rounded-full",children:[(0,a.jsxs)("button",{onClick:()=>h("all"),className:"px-3 py-0.5 rounded-full text-sm transition whitespace-nowrap shrink-0\n                                ".concat("all"===x?"bg-white text-lime-600 font-medium":"bg-gray-50 text-gray-600 hover:bg-white"),children:["All (",v.length,")"]}),y.map(e=>{var t;return(0,a.jsxs)("button",{onClick:()=>h(e._id),className:"px-3 py-0.5 rounded-full text-sm transition whitespace-nowrap shrink-0 capitalize\n                                    ".concat(x===e._id?"bg-white text-lime-600 font-medium":"bg-gray-50 text-gray-600 hover:bg-white","\n                                "),children:[e.name," (",(null==(t=j[e._id])?void 0:t.length)||0,")"]},e._id)})]}),(0,a.jsxs)("div",{className:"relative w-64 shrink-0 ml-4",children:[(0,a.jsx)(o.A,{className:"absolute left-0 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{name:"search",type:"search",placeholder:"Search products/services...",value:u,onChange:e=>m(e.target.value),className:"pl-6 pr-4 py-1.5 w-full\n                                       border-b border-gray-100 text-sm\n                                       text-gray-500 placeholder-gray-300\n                                       focus:outline-none\n                                       focus:border-lime-500\n                                       hover:border-gray-300\n                                       transition duration-300 ease-in-out\n                                       ".concat(u?"bg-lime-50":"bg-transparent","\n                                       [&:-webkit-autofill]:shadow-[inset_0_0_0px_1000px_#f7fee7]\n                                       ")})]})]})}),0===N.length?(0,a.jsx)("div",{className:"flex justify-center items-center flex-1 p-6",children:(0,a.jsxs)("div",{className:"text-center max-w-md w-full p-8 bg-white rounded-2xl shadow-sm border border-gray-100",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDD0D"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No items found"}),(0,a.jsx)("p",{className:"text-gray-500",children:u?"We couldn't find any items matching \"".concat(u,'"'):"There are no items available in this category."}),u&&(0,a.jsx)("button",{onClick:()=>m(""),className:"mt-4 text-lime-600 font-medium hover:text-lime-700 hover:underline",children:"Clear search"})]})}):(0,a.jsx)("div",{onScroll:e=>{let t=e.currentTarget.scrollTop;t>10&&!p?b(!0):t<=10&&p&&b(!1)},className:"flex-1 overflow-auto p-6 space-y-8 bg-white scrollbar-hide",children:N.map(e=>(0,a.jsx)("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500",children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:e.items.map(e=>(e=>{var t;let r,l="servicePrice"in e,n=l?e.servicePrice:e.price,s=l&&e.variants&&e.variants.length>0;if(s){let t=e.variants.map(e=>"number"==typeof e.price?e.price:parseFloat(String(e.price))),a=Math.min(...t),l=Math.max(...t);r=a===l?d(a):"".concat(d(a)," - ").concat(d(l))}else r=d("number"==typeof n?n:parseFloat(String(n)));return(0,a.jsxs)("button",{onClick:()=>{"variants"in e&&e.variants&&e.variants.length>0?f(e):c(e)},className:"p-4 outline-none bg-gray-100 w-full h-[150px]   border border-transparent rounded-md   transform transition-all duration-200   hover:bg-gray-50 hover:scale-[1.02] hover:shadow-lg   text-left flex flex-col justify-between   active:cursor-pointer",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg tracking-medium truncate capitalize",children:e.name}),l&&(null!=(t=e.durationMinutes)?t:0)>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.durationMinutes," mins"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1 mb-2 line-clamp-2",children:l?e.description:"SKU: ".concat(e.sku)})]}),(0,a.jsxs)("div",{className:"mt-2",children:[s&&(0,a.jsxs)("span",{className:"inline-block mt-1 px-2 py-0.5 bg-purple-100 text-purple-600 text-[10px] font-bold uppercase tracking-wider rounded-full",children:[e.variants.length," Variants"]}),(0,a.jsx)("p",{className:"text-md font-medium text-gray-700",children:r})]})]},e._id)})(e))})},e.id))}),g&&(0,a.jsx)(i,{service:g,onSelect:e=>{c({_id:e?"".concat(g._id,"-").concat(e.name):g._id,name:e?"".concat(g.name," - ").concat(e.name):g.name,sku:"SRV",price:e?e.price:g.servicePrice,cost:0,volume:0,showInPos:!0}),f(null)},onClose:()=>f(null)})]})}},5234:(e,t,r)=>{r.d(t,{CartPanel:()=>E});var a=r(5155),l=r(2115),n=r(8892),s=r(874),i=r(194);let o=()=>{let{openTickets:e,fetchOpenTickets:t,loadTicket:r,isTicketsLoading:l,taxRate:o,formatCurrency:c,employees:d}=(0,n._)(),u=e.filter(e=>"COMPLETED"!==e.status);return(0,a.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[(0,a.jsxs)("h3",{className:"font-bold text-gray-700",children:["Open Tickets (",u.length,")"]}),(0,a.jsx)("button",{onClick:t,disabled:l,className:"p-2 text-gray-500 hover:text-lime-700 hover:bg-lime-50 rounded-full transition",title:"Refresh Tickets",children:(0,a.jsx)(s.A,{className:"w-5 h-5 ".concat(l?"animate-spin":"")})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[l&&0===u.length&&(0,a.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Loading..."}),!l&&0===u.length&&(0,a.jsx)("div",{className:"text-center bg-gray-100 rounded-lg p-6 text-gray-500",children:"No pending tickets found."}),u.map(e=>{let t=e.items.reduce((e,t)=>e+t.unitPrice*t.quantity,0);return(0,a.jsxs)("div",{onClick:()=>r(e),className:"group p-3 border border-gray-100 rounded-lg cursor-pointer bg-white transition-all hover:border-gray-300",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,a.jsx)("span",{className:"font-bold text-gray-800 group-hover:text-lime-600 transition-colors",children:e.name||"Unnamed Ticket"}),(0,a.jsx)("span",{className:"font-bold text-lime-600",children:c(t+t*o)})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 flex flex-col gap-1",children:[(0,a.jsxs)("span",{children:["Created: ",(e=>{let t=new Date(e);return isNaN(t.getTime())?"N/A":t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})(e.createdAt)]}),e.crew&&e.crew.length>0&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-gray-500 mt-1",children:[(0,a.jsx)(i.A,{className:"w-3 h-3"}),e.crew.map(e=>{let t="object"==typeof e?e._id:e,r=d.find(e=>e._id===t);return r?r.name:""}).filter(Boolean).join(", ")]})]})]},e._id)})]})]})},c=l.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?l.createElement("title",{id:a},r):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))});var d=r(1715),u=r(6956),m=r(367);let x=e=>{let{onBack:t}=e,{customers:r,currentCustomer:s,setCustomer:i,currentTicketName:o,setCurrentTicketName:x,employees:h,selectedCrew:g,toggleCrewMember:f}=(0,n._)(),[p,b]=(0,l.useState)(""),v=(0,l.useMemo)(()=>{if(!p)return r;let e=p.toLowerCase();return r.filter(t=>t.name.toLowerCase().includes(e)||t.contactInfo&&t.contactInfo.includes(e))},[p,r]);return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-white animate-in slide-in-from-right duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 border-b border-gray-200",children:[(0,a.jsx)("button",{onClick:t,className:"p-2 -ml-2 text-gray-500 hover:text-gray-800 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(c,{className:"w-6 h-6"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:"Assign Customer"})]}),(0,a.jsx)("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by name or mobile...",value:p,onChange:e=>b(e.target.value),className:"w-full pl-10 pr-4 py-3 rounded-xl border-none ring-1 ring-gray-200 focus:ring-2 focus:ring-lime-500 outline-none text-gray-700 bg-white shadow-sm transition-all",autoFocus:!0})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto min-h-0",children:[s&&(0,a.jsxs)("div",{className:"p-4 border-b border-lime-100 bg-lime-50/50",children:[(0,a.jsx)("h3",{className:"text-xs font-bold text-lime-700 uppercase tracking-wider mb-2",children:"Currently Assigned"}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-lime-200 shadow-sm flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold text-gray-900",children:s.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:s.contactInfo||"No contact info"})]}),(0,a.jsx)("button",{onClick:()=>{i(null),x("New Order")},className:"text-xs font-bold text-red-500 hover:bg-red-50 px-3 py-2 rounded-lg transition-colors",children:"Unlink"})]}),s.cars&&s.cars.length>0&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-500 mb-1 block",children:"Selected Vehicle"}),(0,a.jsx)(m.A,{options:s.cars.map(e=>({label:"".concat(e.plateNumber," - ").concat(e.makeModel||"Unknown"),value:e.plateNumber})),value:o.includes(" - ")?o.split(" - ")[1]:s.cars[0].plateNumber,onChange:e=>{x("".concat(s.name," - ").concat(e))},className:"w-full"})]})]}),(0,a.jsxs)("div",{className:"p-2",children:[(0,a.jsx)("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider px-2 py-2",children:"All Customers"}),(0,a.jsxs)("div",{className:"space-y-1",children:[v.map(e=>(0,a.jsxs)("button",{onClick:()=>{i(e);let t=e.cars&&e.cars.length>0?e.cars[0]:null,r=(null==t?void 0:t.plateNumber)||"No Plate";x("".concat(e.name," - ").concat(r))},className:"w-full flex items-center p-3 rounded-xl transition-colors text-left group ".concat((null==s?void 0:s._id)===e._id?"bg-lime-50 border border-lime-200":"hover:bg-gray-50 border border-transparent"),children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 font-bold mr-3 group-hover:bg-white group-hover:shadow-sm transition-all",children:e.name[0]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-semibold ".concat((null==s?void 0:s._id)===e._id?"text-lime-800":"text-gray-800"),children:e.name}),(null==s?void 0:s._id)===e._id&&(0,a.jsx)(u.A,{className:"w-5 h-5 text-lime-600"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.contactInfo||"No contact info"})]})]},e._id)),0===v.length&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No customers found."})]})]})]}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:(0,a.jsx)("button",{onClick:t,className:"w-full py-4 bg-gray-900 text-white font-bold rounded-xl shadow-lg hover:bg-gray-800 transition-all active:scale-[0.98]",children:"Assign Customer"})})]})};var h=r(2019),g=r(3569),f=r(5881),p=r(5239);let b=e=>{let{isOpen:t,onClose:r,onConfirm:s}=e,{total:i,formatCurrency:o}=(0,n._)(),[c,d]=l.useState("Cash");if(!t)return null;let u=[{id:"Cash",label:"Cash",type:"icon",icon:h.A},{id:"GCash",label:"GCash",type:"image",src:"https://upload.wikimedia.org/wikipedia/en/thumb/c/cc/GCash_logo.png/320px-GCash_logo.png"},{id:"Maya",label:"Maya",type:"image",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/PayMaya_Logo.png/330px-PayMaya_Logo.png"},{id:"UnionBank",label:"UnionBank",type:"image",src:"https://upload.wikimedia.org/wikipedia/commons/6/61/Unionbank_2018_logo.svg"},{id:"Security Bank",label:"Security Bank",type:"image",src:"https://upload.wikimedia.org/wikipedia/commons/5/5a/Security_Bank_logo.svg"}];return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6 animate-in zoom-in-95 duration-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Select Payment Method"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(g.A,{className:"w-6 h-6"})})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:u.map(e=>(0,a.jsx)("button",{onClick:()=>d(e.id),className:"flex flex-col items-center justify-center gap-3 p-4 rounded-xl border font-medium transition-all h-24 ".concat(c===e.id?"border-lime-500 text-lime-800 bg-lime-50 shadow-sm ring-2 ring-lime-200":"border-gray-200 text-gray-600 hover:border-gray-300 hover:bg-gray-50"),children:"image"===e.type&&e.src?(0,a.jsx)("div",{className:"relative w-full h-full overflow-hidden p-2",children:(0,a.jsx)(p.default,{src:e.src,alt:e.label,fill:!0,className:"object-contain",sizes:"120px",unoptimized:!0})}):(0,a.jsx)("div",{className:"p-2 rounded-full ".concat(c===e.id?"bg-lime-200 text-lime-700":"bg-gray-100 text-gray-500"),children:e.icon?(0,a.jsx)(e.icon,{className:"w-6 h-6"}):(0,a.jsx)(f.A,{className:"w-6 h-6"})})},e.id))}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-500 px-1",children:[(0,a.jsx)("span",{children:"Total Amount:"}),(0,a.jsx)("span",{className:"font-bold text-gray-900 text-lg",children:o(i)})]}),(0,a.jsxs)("button",{onClick:()=>s(c),className:"w-full py-3.5 bg-lime-600 text-white font-bold rounded-xl shadow-lg hover:bg-lime-700 hover:shadow-lime-200/50 transition-all active:scale-[0.98]",children:["Confirm Payment (",c,")"]})]})]})})},v=l.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?l.createElement("title",{id:a},r):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))});var y=r(9537);let w=e=>{let{ticketNameInput:t,setTicketNameInput:r,onCustomerClick:l}=e,{cartItems:s,currentCustomer:i}=(0,n._)(),o=0===s.length;return(0,a.jsxs)("div",{className:"flex-none bg-white border-b border-gray-200 px-5 py-5 z-10 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)("input",{type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"Current Sale",className:"text-xl font-bold text-gray-800 placeholder-gray-300 outline-none bg-transparent border-transparent border-b p-2 focus:bg-gray-50 focus:ring-0 focus:border-lime-400 focus:border-b w-full"}),!o&&(0,a.jsx)("span",{className:"text-xs font-bold text-gray-500 bg-gray-100 px-2 py-1 rounded-md",children:s.length})]}),(0,a.jsxs)("button",{onClick:l,className:"w-full flex items-center justify-between p-3 rounded-lg bg-gray-50 hover:bg-gray-100 transition-all outline-none group",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold shadow-sm transition-colors ".concat(i?"bg-white text-blue-600 ring-1 ring-gray-100":"bg-gray-200 text-gray-500"),children:i?(()=>{let e=i.name.trim().split(" ");return 1===e.length?e[0].substring(0,2).toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()})():(0,a.jsx)(v,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex flex-col items-start",children:[(0,a.jsx)("span",{className:"font-bold text-sm leading-tight ".concat(i?"text-gray-900":"text-gray-500"),children:i?i.name:"Add Customer"}),(0,a.jsx)("span",{className:"text-xs text-gray-400 font-medium",children:i?i.contactInfo||"Customer linked":"Assign to ticket"})]})]}),(0,a.jsx)(y.A,{className:"w-4 h-4 text-gray-400 group-hover:text-gray-600"})]})]})};var j=r(7218);let N=l.forwardRef(function(e,t){let{title:r,titleId:a,...n}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?l.createElement("title",{id:a},r):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}),k=()=>{let{cartItems:e,updateItemQuantity:t,removeItem:r,formatCurrency:l}=(0,n._)(),s=0===e.length;return(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-2 min-h-0 bg-white",children:s?(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-300 space-y-4",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-4xl opacity-50",children:"\uD83D\uDECD️"})}),(0,a.jsx)("p",{className:"font-medium",children:"No items in cart"})]}):(0,a.jsx)("div",{children:e.map(e=>(0,a.jsxs)("div",{className:"flex items-center py-4 px-5 animate-in fade-in slide-in-from-bottom-1 duration-200 hover:bg-gray-50 transition-colors group",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center mr-3 gap-2",children:[(0,a.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:r=>t(e._id,parseInt(r.target.value)||1),className:"w-12 h-12 text-center justify-center font-bold text-md text-gray-700 bg-white border border-transparent rounded-md focus:border-lime-500 focus:ring-1 focus:ring-lime-500 outline-none transition-all [&::-webkit-inner-spin-button]:appearance-none group-hover:border-lime-500 group-hover:ring-lime-500"}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>t(e._id,e.quantity+1),className:"p-1 rounded-full text-transparent hover:text-green-600 hover:bg-green-100 hover:[&>svg]:stroke-2 transition-colors group-hover:text-green-600 group-hover:bg-green-100",children:(0,a.jsx)(j.A,{className:"w-3 h-3"})}),(0,a.jsx)("button",{onClick:()=>t(e._id,Math.max(1,e.quantity-1)),className:"p-1 rounded-full text-transparent hover:text-rose-600 hover:bg-rose-100 hover:[&>svg]:stroke-2 transition-colors group-hover:text-rose-600 group-hover:bg-rose-100",children:(0,a.jsx)(N,{className:"w-3 h-3"})})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex justify-between items-center min-w-0",children:[(0,a.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 text-lg leading-tight truncate px-1 capitalize",title:e.name,children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 mt-0.5 px-1",children:[l(e.price)," each"]})]}),(0,a.jsx)("span",{className:"font-bold text-gray-800 whitespace-nowrap ml-3",children:l(e.itemTotal)})]}),(0,a.jsx)("button",{onClick:()=>r(e._id),className:"ml-3 p-2 text-gray-300 hover:text-rose-600 hover:bg-rose-100 hover:[&>svg]:stroke-2 rounded-full opacity-0 group-hover:opacity-100 transition-all font-medium",title:"Remove Item",children:(0,a.jsx)(g.A,{className:"w-5 h-5"})})]},e._id))})})},C=e=>{let{onSave:t,onCheckoutClick:r,isBusy:l}=e,{cartItems:s,subtotal:i,tax:o,total:c,checkoutError:d,taxRate:u,formatCurrency:m}=(0,n._)(),x=0===s.length;return(0,a.jsxs)("div",{className:"bg-white border-t border-gray-200",children:[d&&(0,a.jsxs)("div",{className:"mx-4 mt-3 mb-1 p-3 bg-red-50 text-red-600 text-sm font-medium rounded-lg border border-red-100 flex items-center justify-between",children:[(0,a.jsx)("span",{children:d}),(0,a.jsx)(g.A,{className:"w-4 h-4 cursor-pointer"})]}),(0,a.jsxs)("div",{className:"px-6 py-4 space-y-2 border-b border-gray-100 bg-gray-50/50",children:[(0,a.jsxs)("div",{className:"flex justify-between text-gray-500 text-sm",children:[(0,a.jsx)("span",{children:"Subtotal"}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:m(i)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-gray-500 text-sm",children:[(0,a.jsxs)("span",{children:["Tax (",Number((100*u).toFixed(2)),"%)"]}),(0,a.jsx)("span",{className:"font-medium text-gray-700",children:m(o)})]})]}),(0,a.jsxs)("div",{className:"p-4 bg-white grid grid-cols-[auto_1fr] gap-3",children:[(0,a.jsx)("button",{onClick:t,disabled:x||l,className:"flex flex-col items-center justify-center px-6 rounded-xl border border-gray-200 text-gray-600 font-bold text-sm hover:border-gray-300 hover:text-lime-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all active:scale-95",children:(0,a.jsx)("span",{children:"Save"})}),(0,a.jsxs)("button",{onClick:r,disabled:x||l,className:"relative overflow-hidden flex items-center justify-between px-6 py-4 rounded-xl bg-lime-600 text-white hover:bg-lime-700 transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed group",children:[(0,a.jsxs)("div",{className:"flex flex-col items-start z-10",children:[(0,a.jsx)("span",{className:"text-xl font-bold tracking-wide",children:"Charge"}),(0,a.jsxs)("span",{className:"text-xs font-medium text-lime-100 opacity-80",children:[s.length," Items"]})]}),(0,a.jsx)("span",{className:"text-2xl font-bold z-10",children:m(c)}),(0,a.jsx)("div",{className:"absolute inset-0 bg-linear-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shimmer"})]})]})]})};function E(){let{viewMode:e,isProcessing:t,checkout:r,saveTicket:s,currentTicketName:i}=(0,n._)(),[c,d]=(0,l.useState)("MAIN"),[u,m]=(0,l.useState)(!1),[h,g]=(0,l.useState)("");(0,l.useEffect)(()=>{g(i)},[i]);let f=async()=>{await s(h)};return"TICKETS"===e?(0,a.jsx)("div",{className:"w-[450px] bg-white flex flex-col h-full border-l border-gray-200",children:(0,a.jsx)(o,{})}):"CUSTOMER_SETUP"===c?(0,a.jsx)("div",{className:"w-[450px] bg-white flex flex-col h-full border-l border-gray-200 relative",children:(0,a.jsx)(x,{onBack:()=>d("MAIN")})}):(0,a.jsxs)("div",{className:"w-[450px] bg-white flex flex-col h-full border-l border-gray-200 relative",children:[(0,a.jsx)(b,{isOpen:u,onClose:()=>m(!1),onConfirm:e=>{r(e),m(!1)}}),(0,a.jsx)(w,{ticketNameInput:h,setTicketNameInput:g,onCustomerClick:()=>d("CUSTOMER_SETUP")}),(0,a.jsx)(k,{}),(0,a.jsx)(C,{onSave:f,onCheckoutClick:()=>{m(!0)},isBusy:t})]})}},5748:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))})},5881:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"}))})},6059:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))})},6956:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})},7218:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))})},8892:(e,t,r)=>{r.d(t,{CartProvider:()=>d,_:()=>c});var a=r(5155),l=r(2115),n=r(8720);let s=(0,l.createContext)(void 0),i="/api",o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[r,a]=(0,l.useState)([]),[s,o]=(0,l.useState)(0),[c,d]=(0,l.useState)("PHP"),[u,m]=(0,l.useState)(!1),[x,h]=(0,l.useState)(!1),[g,f]=(0,l.useState)(null),[p,b]=(0,l.useState)(null),[v,y]=(0,l.useState)("New Order"),[w,j]=(0,l.useState)("TICKETS"),[N,k]=(0,l.useState)([]),[C,E]=(0,l.useState)(e),[_,S]=(0,l.useState)(null),[A]=(0,l.useState)(t),[L,M]=(0,l.useState)([]);(0,l.useEffect)(()=>{(async()=>{if(i)try{let e=await fetch("".concat(i,"/settings"));if(e.ok){let t=await e.json();void 0!==t.tax_rate&&o(t.tax_rate),t.currency&&d(t.currency)}}catch(e){console.error("Failed to fetch settings:",e)}})()},[]);let{subtotal:T,tax:P,total:R}=(0,l.useMemo)(()=>{let e=r.reduce((e,t)=>e+t.itemTotal,0),t=e*s;return{subtotal:e,tax:t,total:e+t}},[r,s]),I=(0,l.useCallback)(e=>{let t="USD"===c?"$":"EUR"===c?"€":"₱";return"".concat(t).concat(e.toFixed(2))},[c]),O=(0,l.useCallback)(e=>{let t=(e=>{let t=parseFloat(String(e));return isNaN(t)?0:t})(e.price);0===r.length&&(b(null),y("New Order")),j("CART"),a(r=>r.find(t=>t._id===e._id)?r.map(r=>r._id===e._id?{...r,quantity:r.quantity+1,itemTotal:(r.quantity+1)*t}:r):[...r,{product:e,quantity:1,price:t,itemTotal:t,name:e.name,sku:e.sku,_id:e._id}])},[r.length]),B=(0,l.useCallback)((e,t)=>{let r=Math.max(1,t);a(t=>t.map(t=>t._id===e?{...t,quantity:r,itemTotal:r*t.price}:t))},[]),U=(0,l.useCallback)(e=>{a(t=>t.filter(t=>t._id!==e))},[]),z=(0,l.useCallback)(()=>{a([]),b(null),y("New Order"),S(null),M([]),f(null)},[]),D=(0,l.useCallback)(()=>j("CART"),[]),W=(0,l.useCallback)(()=>j("TICKETS"),[]),q=(0,l.useCallback)(e=>{M(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),F=(0,l.useCallback)(async()=>{if(i){h(!0);try{let e=await fetch("".concat(i,"/tickets"),{cache:"no-store"});if(!e.ok)throw Error("Failed to fetch tickets");let t=await e.json();k(t)}catch(e){console.error(e)}finally{h(!1)}}},[]);(0,l.useEffect)(()=>{F()},[F]);let Z=(0,l.useCallback)(e=>{a(e.items.map(e=>{let t=e.productName||"Item ".concat(e.productId.slice(0,4));return{product:{_id:e.productId,name:t,sku:"TICKET",price:e.unitPrice,cost:0,volume:0,showInPos:!0},quantity:e.quantity,price:e.unitPrice,itemTotal:e.unitPrice*e.quantity,_id:e.productId,name:t,sku:"TICKET"}})),y(e.name),b(e._id),e.customer?"object"==typeof e.customer&&e.customer._id?S(e.customer):"string"==typeof e.customer?S(C.find(t=>t._id===e.customer)||null):S(null):S(null),e.crew&&Array.isArray(e.crew)?M(e.crew.map(e=>"object"==typeof e?e._id:e)):M([]),j("CART")},[C]),H=(0,l.useCallback)((e,t,a)=>({status:e,items:r.map(e=>({productId:e._id,productName:e.name,quantity:e.quantity,unitPrice:e.price})),subtotal:T,tax:P,total:R,cashierId:"POS-T1",paymentMethod:a||"Cash",timestamp:new Date().toISOString(),name:t||v,customer:null==_?void 0:_._id,crew:L}),[r,T,P,R,v,_,L]),V=(0,l.useCallback)(async e=>{if(0!==r.length&&!u){if(!i)return f("API Not Configured");m(!0),f(null);try{let t=!p,r=t?"".concat(i,"/tickets"):"".concat(i,"/tickets/").concat(p),a=await fetch(r,{method:t?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(H("PENDING",e))});if(!a.ok)throw Error("Save failed");let l=await a.json();b(l._id),y(l.name),n.oR.success("Ticket ".concat(t?"Created":"Updated")),F(),W(),z()}catch(t){let e="Error saving ticket";t instanceof Error&&(e=t.message),f(e),n.oR.error(e)}finally{m(!1)}}},[r.length,u,p,H,F,W,z]),G=(0,l.useCallback)(async e=>{if(i){m(!0);try{if(!(await fetch("".concat(i,"/tickets/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete ticket");p===e&&z(),await F(),n.oR.success("Ticket deleted")}catch(e){console.error(e),n.oR.error("Failed to delete ticket")}finally{m(!1)}}},[i,p,z,F]),K=(0,l.useCallback)(async e=>{if(0!==r.length&&!u){if(!i)return f("API Not Configured");m(!0),f(null);try{let t=!p,r=t?"".concat(i,"/tickets"):"".concat(i,"/tickets/").concat(p);if(!(await fetch(r,{method:t?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(H("COMPLETED",void 0,e))})).ok)throw Error("Checkout failed");n.oR.success("Checkout Complete (".concat(e,"): ").concat(I(R))),b(null),y("New Order"),z(),await F(),W()}catch(t){let e="Checkout Error";t instanceof Error&&(e=t.message),f(e),n.oR.error(e)}finally{m(!1)}}},[r.length,u,p,H,R,z,F,W,I]);return(0,l.useMemo)(()=>({cartItems:r,viewMode:w,openTickets:N,currentTicketId:p,currentTicketName:v,isProcessing:u,isTicketsLoading:x,checkoutError:g,subtotal:T,tax:P,total:R,taxRate:s,currency:c,formatCurrency:I,addItemToCart:O,updateItemQuantity:B,removeItem:U,clearCart:z,setCurrentTicketName:y,switchToCartView:D,switchToTicketsView:W,fetchOpenTickets:F,loadTicket:Z,checkout:K,saveTicket:V,deleteTicket:G,customers:C,setCustomer:S,currentCustomer:_,employees:A,selectedCrew:L,toggleCrewMember:q}),[r,w,N,p,v,u,x,g,T,P,R,s,c,I,O,B,U,z,y,D,W,F,Z,K,V,G,C,_,A,L,q])};function c(){let e=(0,l.useContext)(s);if(!e)throw Error("useCart must be used within a CartProvider");return e}function d(e){let{children:t,initialCustomers:r,initialEmployees:l}=e,n=o(r,l);return(0,a.jsx)(s.Provider,{value:n,children:t})}},9537:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(2115);let l=a.forwardRef(function(e,t){let{title:r,titleId:l,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},n),r?a.createElement("title",{id:l},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))})},9749:(e,t,r)=>{r.d(t,{t:()=>l});var a=r(2115);let l=()=>{let[e,t]=(0,a.useState)(null),[r,l]=(0,a.useState)(!0),[n,s]=(0,a.useState)(null),i="/api";return(0,a.useEffect)(()=>{(async()=>{if(!i)return l(!1);try{let l=await fetch("".concat(i,"/settings"));if(l.ok){var e,r,a,n,o,c,d;let s=await l.json();t({storeName:s.name||"",storeAddress:(null==(e=s.address)?void 0:e.street)||"",currency:s.currency||"PHP",taxRate:void 0!==s.tax_rate?Number(s.tax_rate):.08,enableNotifications:null==(d=null==(r=s.settings)?void 0:r.enableNotifications)||d,receiptHeader:(null==(a=s.receipt)?void 0:a.header)||"",receiptFooter:(null==(n=s.receipt)?void 0:n.footer)||"",printerName:(null==(o=s.receipt)?void 0:o.printerName)||"",theme:(null==(c=s.settings)?void 0:c.theme)||"light"})}else s("Failed to fetch settings")}catch(e){console.error(e),s("Error fetching settings")}finally{l(!1)}})()},[i]),{settings:e,loading:r,error:n,formatCurrency:t=>{let r=(null==e?void 0:e.currency)==="USD"?"$":(null==e?void 0:e.currency)==="EUR"?"€":"₱";return"".concat(r).concat(t.toFixed(2))},getCurrencySymbol:()=>e?"USD"===e.currency?"$":"EUR"===e.currency?"€":"₱":"₱"}}}}]);